---
title: Wireless Connections Between Raspberry Pi and Pico 2W
---

import { YouTube } from 'astro-embed';

Now that we understand the fundamentals of communication protocols, let's explore how to establish wireless connections between our Raspberry Pi 4B and Raspberry Pi Pico 2W. Wireless communication allows for flexible device placement and eliminates the need for physical cables, enabling more dynamic project implementations.

In this module, we'll focus on two primary wireless methods: Wi-Fi and Bluetooth. Each offers distinct advantages and is suited for different applications in your projects.

:::note[Think about It: Choosing the Right Wireless Protocol]

- What factors would influence your choice between Wi-Fi and Bluetooth for a project?
- How do range, power consumption, and data rate requirements affect this decision?
- What security considerations should you keep in mind when implementing wireless communication?
- In what scenarios might you need to use both protocols in the same project?

:::

## Method 1: Wi-Fi Communication

Wi-Fi provides high-bandwidth network connectivity and is perfect for applications requiring Internet access or data transfer across longer distances. The Raspberry Pi Pico 2W comes with built-in Wi-Fi capabilities that we can leverage with MicroPython.

:::note[Remember]
Always connect the Raspberry Pi 4B with Pico 2W using Thonny and install the needed MicroPython so that you can develop the code on the Pico 2W. The following code should be executed on the Pico 2W unless explicitely specified to be executed on the Raspberry Pi.
:::

### Finding Available Networks

Before connecting to a Wi-Fi network, it's useful to scan for available networks in the area. This helps identify the SSID (network name) to connect to.

```python
import network
# Init Wi-Fi interface
wlan = network.WLAN(network.STA_IF)
wlan.active(True)
# Scan for Wi-Fi networks
networks = wlan.scan()
# Print Wi-Fi networks
print("Available WiFi Networks:")
for network_info in networks:
    print(network_info)

```

#### Understanding Network Information

When you run the scan, each network is represented as a tuple containing:
SSID (network name)
BSSID (access point MAC address)
Channel number
RSSI (signal strength)
Security type
Hidden network flag.

This information helps you identify the strongest networks and their security types.

### Connecting to a Wi-Fi Network

Once you've identified the network you want to connect to, you can establish a connection using its SSID and password:

```python
import network
from time import sleep
# Wi-Fi credentials
ssid = 'YOUR_NETWORK_NAME'
password = 'YOUR_PASSWORD'
# Init Wi-Fi Interface
wlan = network.WLAN(network.STA_IF)
wlan.active(True)
# Connect to your network
wlan.connect(ssid, password)
# Wait for Wi-Fi connection
connection_timeout = 10
while connection_timeout > 0:
    if wlan.status() >= 3:
        break
    connection_timeout -= 1
    print('Waiting for Wi-Fi connection...')
    sleep(1)
# Check if connection is successful
if wlan.status() != 3:
    raise RuntimeError('Failed to establish a network connection')
else:
    print('Connection successful!')
    network_info = wlan.ifconfig()
    print('IP address:', network_info[0])
```

Your Pico 2W is now connected to wifi and can send and receive data wirelessly now. Connect you RPi to the same wifi and now we can start communicating between the devices.

### Controlling hardware wirelessly

:::tip[Activity: Creating a Web Server on Pico 2W]

One of the most powerful applications of Wi-Fi connectivity is creating a web server. This allows any device on the same network to interact with the Pico 2W through a web browser, making it perfect for control panels, data visualization, and remote monitoring.

In this activity, we'll set up the Pico 2W as a web server that controls and displays the onboard LED state. The Raspberry Pi 4B (or any device on the network) can access this web page.

**Step 1: Program the Pico 2W as a Web Server**

```python
import network
from time import sleep
import socket
# Import necessary classes for hardware control
from machine import Pin, Timer
# Create a Pin object for the onboard LED
led = machine.Pin("LED", machine.Pin.OUT)
# Wi-Fi credentials
ssid = 'YOUR_NETWORK_NAME'
password = 'YOUR_PASSWORD'
def connect():
    # Init Wi-Fi Interface
    wlan = network.WLAN(network.STA_IF)
    wlan.active(True)
    # Connect to your network
    wlan.connect(ssid, password)
    # Wait for Wi-Fi connection
    connection_timeout = 10
    while connection_timeout > 0:
        if wlan.status() >= 3:
            break
        connection_timeout -= 1
        print('Waiting for Wi-Fi connection...')
        sleep(1)
    # Check if connection is successful
    if wlan.status() != 3:
        raise RuntimeError('Failed to establish a network connection')
    else:
        print('Connection successful!')
        network_info = wlan.ifconfig()
        print('IP address:', network_info[0])
        return network_info[0]
def open_socket(ip):
    # Open a socket
    address = (ip, 80)
    connection = socket.socket()
    connection.bind(address)
    connection.listen(1)
    print(connection)
    return connection

def webpage(state):
    #Template HTML
    html = f"""
            <!DOCTYPE html>
            <html>
            <form action="./lighton">
            <input type="submit" value="Light on" />
            </form>
            <form action="./lightoff">
            <input type="submit" value="Light off" />
            </form>
            <p>LED is {state}</p>
            </body>
            </html>
            """
    return str(html)
def serve(connection):
    #Start a web server
    state = 'OFF'
    led.off()
    temperature = 0
    while True:
        client = connection.accept()[0]
        request = client.recv(1024)
        request = str(request)
        try:
            request = request.split()[1]
        except IndexError:
            pass
        if request == '/lighton?':
            led.on()
            state = 'ON'
        elif request =='/lightoff?':
            led.off()
            state = 'OFF'
        html = webpage(state)
        client.send(html)
        client.close()
try:
    ip = connect()
    connection = open_socket(ip)
    serve(connection)
except KeyboardInterrupt:
    machine.reset()
```

**Step 2: Access the Web Server from Raspberry Pi 4B**

1. After uploading the code to the Pico 2W, note the IP address printed in the Thonny shell.
2. Open a web browser on the Raspberry Pi 4B.
3. Enter the IP address of the Pico 2W in the address bar (e.g., `http://192.168.xx.xx`).
4. You should see a web page displaying the current LED satate and two buttons to control the LED from the Pico 2W.

**What's Happening?**

- The Pico 2W connects to your WiFi network.
- It starts a web server listening on port 80.
- When a browser (from any device on the network) connects to its IP address, it responds with HTML code that the browser displays as web page.
- The web page displays the current LED state and two buttons to control the LED.
- This demonstrates IoT principles with a device providing data over the network

**Understanding the code**

1. `Connection Setup`: `The connect()` function establishes a Wi-Fi connection and returns the assigned IP address
2. `Socket Creation`: `open_socket()` creates a network socket listening on port 80 (standard HTTP port)
3. `HTML Generation`: `webpage()` generates a simple HTML page with buttons to control the LED
4. `Request Handling`: `serve()` processes incoming HTTP requests and updates the LED state
5. `User Interaction`: From any device on the same network, opening a browser and navigating to the Pico's IP address displays the control page

This example demonstrates core concepts in IoT (Internet of Things) development, where physical devices can be controlled through standard web interfaces.

:::

:::tip[Activity: Advanced Web Control Panel]

Enhance the basic web server to create a more comprehensive control panel:

1. Add `CSS` Styling: Improve the web interface with better styling.
2. Add Temperature Reading: Include the Pico's internal temperature in the display.
3. Add Automatic Refresh: Make the page update values without manual refreshing.
4. Add Multiple LED Controls: If you have external LEDs connected, add controls for them.

:::

## Method 2: Bluetooth Communication

The Raspberry Pi Pico 2W also has Bluetooth capabilities, allowing for direct device-to-device communication without needing a network infrastructure. While Wi-Fi excels at longer range and higher bandwidth applications, Bluetooth offers better power efficiency and direct device-to-device connectivity without requiring a network infrastructure. The Raspberry Pi Pico 2W supports Bluetooth Low Energy (BLE), which is perfect for lower-power applications.

### Understanding BLE on Pico 2W

Bluetooth Low Energy works on a peripheral/central device model:

- **Peripheral**: A device that advertises its presence and provides data or services (in our case the `Pico 2W`)
- **Central**: A device that scans for and connects to peripherals (in our case `Raspberry Pi 4B`)

Communication happens through defined characteristics that can be read from or written to.

### Setting Up BLE on Pico 2W

To use BLE on the Pico 2W, we need the `bluetooth` module and a helper file called `ble_simple_peripheral.py`:

```python
# Basic Bluetooth setup on Pico 2W
import bluetooth
from ble_simple_peripheral import BLESimplePeripheral
import time
from machine import Pin

# Create a Bluetooth Low Energy (BLE) object
ble = bluetooth.BLE()
# Create a BLE peripheral
sp = BLESimplePeripheral(ble)

# LED for status indication
led = Pin("LED", Pin.OUT)

def on_rx(data):
    print("Received:", data.decode())
    if data == b'toggle':
        led.toggle()
    elif data == b'on':
        led.on()
    elif data == b'off':
        led.off()

# Wait for connections
while True:
    if sp.is_connected():
        # If connected, wait for instructions
        sp.on_write(on_rx)
        # Show connected status with LED on
        led.on()
    else:
        # If not connected, blink LED slowly
        led.toggle()
        time.sleep(0.5)
```
